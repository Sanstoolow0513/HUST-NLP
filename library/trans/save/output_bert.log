加载数据: ../data/datasave.pkl
数据加载成功。训练集: 156444, 测试集: 17383
词表大小: 5169, 标签数: 4
模型结构:
BertSegmenter(
  (bert): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(21128, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0-11): 12 x BertLayer(
          (attention): BertAttention(
            (self): BertSdpaSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
            (intermediate_act_fn): GELUActivation()
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (dropout): Dropout(p=0.1, inplace=False)
  (classifier): Linear(in_features=768, out_features=4, bias=True)
)

开始训练...
Epoch 1/5 | Time: 1054.81s | LR: 0.000016
  Train Loss: 0.0746
  Val Loss: 0.0380 | Val Acc: 0.9880
  模型已保存到: bert_segmenter_best.pth (Best Loss)
------------------------------------------------------------
Epoch 2/5 | Time: 1055.83s | LR: 0.000012
  Train Loss: 0.0244
  Val Loss: 0.0262 | Val Acc: 0.9922
  模型已保存到: bert_segmenter_best.pth (Best Loss)
------------------------------------------------------------
Epoch 3/5 | Time: 1150.17s | LR: 0.000008
  Train Loss: 0.0098
  Val Loss: 0.0290 | Val Acc: 0.9935
------------------------------------------------------------
Epoch 4/5 | Time: 1266.52s | LR: 0.000004
  Train Loss: 0.0040
  Val Loss: 0.0315 | Val Acc: 0.9943
------------------------------------------------------------
Epoch 5/5 | Time: 1055.89s | LR: 0.000000
  Train Loss: 0.0018
  Val Loss: 0.0368 | Val Acc: 0.9945
------------------------------------------------------------
训练完成！
最佳验证损失: 0.0262
